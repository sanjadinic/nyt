<!DOCTYPE html>
<html lang="en">
<head>
  <title></title>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width">
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <style type="text/css">
    body {
  background: #F3F3F3;
  padding: 20px;
  font-family: "Open Sans", sans-serif;
}
.column {
  flex-basis: percentage(1/3);
  width: percentage(1/3);
  padding: 0 10px;
  box-sizing: border-box;
  
}

   
.article {
  background: #FFF;
  margin: 0 0 20px;
  padding: 20px;
  border-radius: 2px;
  box-shadow: 0 2px 4px rgba(#000, 0.2);
  cursor: pointer;
  transition: 0.3s ease;
  
  }
    </style>
</head>
<body>
<h1>Search articles from New York Times</h1>
<section id="search">
   <div id="root">
    <App>
        <selector>
           <form id="param" novalidate onsubmit="find(event)">    
              <input id="month" type="number" min="1" max="12" value="1" placeholder="Enter month" required>    
              
              <input id="year" type="number" min="1851" max="2018" value="2018" placeholder="Enter year" required>    
              <button type="submit">Find</button>
            </form> 
          </selector>
                <Results/>
                <ArticleDetails/>
    </App>
        </div>
      </section>
  <script type="text/babel">

 class App extends React.Component {

  constructor(props){    
  super(props);    
  this.state = {'urls': []};    
  this.onSuccess = this.onSuccess.bind(this); 
  }
  onSuccess(responseData) {    
  let urls = [];    
  for(var i = 0; i < 20; i++) {      
  const doc = responseData.response.docs[i];      
  urls.push(doc.web_url);    
}    
  this.setState({'urls': urls});  
}
  componentDidMount(){    
  $.ajax({        
  url: 'https://api.nytimes.com/svc/archive/v1/2017/2.json',        
  method: 'GET',        
  data: {            
  'api-key': "581847de71484ddba4e5ae5eee1b92e4"        
},        
success: this.onSuccess    
});  }
  render(){    
  return (      
  <div className="column">{this.state.urls.map((url) => <Url url={url}/>)}</div>
    );  }
}

function Url(props){  
return <article className="article"><a href={props.url}>{props.url}</a></article>; 
}

function ArticleDetails(props){
    return (
        <div>
            {
              props.urls.map(
                (url, index) => <Url key={index} url={url}/>
              )
            }
        </div>
    );
}

function Results(props){

    return (
        <div>
            <ArticlePreview webUrl={props.urls} />
        </div>
    )
}

class ArticlePreview extends React.Component {
         componentDidMount(){
           $.ajax({
              url: 'https://api.linkpreview.net',
              method: 'GET',
              data: {
                  'key': "5a915cd51a38ad77da5d9698f24ff9055107e7a053d34",
                  'q': this.props.webUrl
              },
              success: this.onSuccess
          });
    }
    render(){

        return  (
            <div>  
                <img src={this.state.img}/>
                <h3>{this.state.title}</h3>
                <p>{this.state.description}</p>
            </div>
        );
    }
}
function find(event){

    const root = document.getElementById('root');
    ReactDOM.render(<App />, root)
}


</script>
</body>
</html>